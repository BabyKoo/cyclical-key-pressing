<!--
 * @Author: Hugo Koo
 * @Date: 2021-12-14 09:17:52
 * @LastEditors: Hugo Koo
 * @LastEditTime: 2021-12-22 16:00:21
 * @Description: 
 * @FilePath: 
-->
<!DOCTYPE html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Screen doesn't lock</title>
</head>

<body>
    <div id="begin-at"></div>
    <div id="current-time"></div>
    <div id="main-msg"></div>
    <div id="counter"></div>
    <div id="time-gap"></div>
    <span>Set Time Gap: </span>
    <input id="time-gap-input" placeholder="secs" value="60" />
    <span>Secs. </span>
    <button onclick="execute(document.getElementById('time-gap-input').value)">Set</button>
    <div></div>
    <button onclick="execute(60)">1 min</button>
    <button onclick="execute(3600)">1 h</button>
    <script type="text/javascript">
        let status = "Pressed Key";
        let counter = 0;
        let pressKeyIntervalID = 0;
        function pressKey(key) {
            let objWs = new ActiveXObject("Wscript.Shell");
            objWs.SendKeys(key);
            objWs.SendKeys(key);
            status = "Key: " + key;
        }
        function counterIncrease() {
            counter++;
            document.getElementById("main-msg").innerText = status;
            document.getElementById("counter").innerText = "Counts: " + counter;
        }
        function counterClear() {
            counter = 0;
            document.getElementById("counter").innerText = "Counts: " + counter;
        }
        function showTimeGap(gap) {
            document.getElementById("time-gap").innerText = "Time gap: " + gap + " sec(s)";
        }
        function showCurrentTime() {
            document.getElementById("current-time").innerText = "Current Time:  " + new Date;
        };
        showCurrentTime();
        setInterval("showCurrentTime()", 1000);
        function execute(p) {
            console.log(p);
            document.getElementById("begin-at").innerText = "Begin @ " + new Date;
            pressKey("{SCROLLLOCK}");
            counterClear()
            counterPlus();
            showTimeGap(p);
            clearInterval(pressKeyIntervalID);
            pressKeyIntervalID = setInterval("pressKey('{SCROLLLOCK}'); counterIncrease();", parseInt(p) * 1000);
        };
    </script>
</body>

</html>